<!-- SKELETON LOADING (nhỏ, gọn) -->
<div *ngIf="loading" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-pulse">
  <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
    <main class="lg:col-span-3">
      <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
        <div
          *ngFor="let i of [1, 2, 3, 4, 5, 6]"
          class="bg-white rounded-xl border border-stone-200 overflow-hidden"
        >
          <div class="aspect-square bg-stone-200"></div>

          <div class="p-4 space-y-3">
            <div class="h-4 bg-stone-200 rounded w-3/4"></div>
            <div class="h-3 bg-stone-200 rounded w-1/2"></div>
            <div class="h-9 bg-stone-200 rounded-lg"></div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
<div *ngIf="!loading">
  <div class="min-h-screen bg-stone-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="mb-10">
        <h1 class="text-3xl font-semibold text-stone-900 mb-2">Your Wishlist</h1>
        <p class="text-stone-600">
          {{ wishlistItems.length }} saved item{{ wishlistItems.length !== 1 ? 's' : '' }}
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <aside class="lg:col-span-1 space-y-6">
          <div class="bg-white rounded-xl border border-stone-200 p-5 sticky top-8">
            <div class="mb-6">
              <h3 class="text-xs font-semibold text-stone-900 uppercase tracking-wider mb-4">
                Wishlist Summary
              </h3>
              <div class="space-y-3 text-sm">
                <div class="flex justify-between border-b border-stone-100 pb-2">
                  <span class="text-stone-600">Items</span>
                  <span class="font-medium text-stone-900">{{ totalItems }}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-stone-600">Total Value</span>
                  <span class="text-lg font-semibold text-stone-900"
                    >${{ totalValue.toFixed(2) }}</span
                  >
                </div>
              </div>
            </div>
            <div class="mb-6">
              <h3 class="text-xs font-semibold text-stone-900 uppercase tracking-wider mb-3">
                Room Filter
              </h3>
              <div class="space-y-2 text-sm">
                <label class="flex items-center gap-2">
                  <input type="checkbox" class="rounded border-stone-300 text-stone-800" /> Living
                  Room
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" class="rounded border-stone-300 text-stone-800" /> Bedroom
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" class="rounded border-stone-300 text-stone-800" /> Dining
                  Room
                </label>
              </div>
            </div>
            <div class="space-y-2 pt-4 border-t border-stone-200">
              <button
                (click)="addAllToCart()"
                [disabled]="wishlistItems.length === 0"
                class="w-full py-2.5 bg-stone-900 text-white text-sm font-medium rounded-lg hover:bg-stone-800 transition disabled:opacity-40"
              >
                Add All to Cart
              </button>
              <button
                (click)="clearWishlist()"
                [disabled]="wishlistItems.length === 0"
                class="w-full py-2.5 border border-stone-300 text-stone-700 text-sm rounded-lg hover:bg-stone-50 transition disabled:opacity-40"
              >
                Clear Wishlist
              </button>
            </div>
          </div>
        </aside>
        <main class="lg:col-span-3">
          <div
            *ngIf="wishlistItems.length === 0"
            class="bg-white rounded-xl border border-stone-200 p-12 text-center"
          >
            <h3 class="text-xl font-semibold text-stone-900 mb-2">Your wishlist is empty</h3>
            <p class="text-stone-600 mb-6">Save furniture you love and revisit them anytime.</p>
            <a
              routerLink="/products"
              class="inline-block px-6 py-2.5 bg-stone-900 text-white rounded-lg text-sm hover:bg-stone-800"
              >Browse Products</a
            >
          </div>
          <div
            *ngIf="wishlistItems.length > 0"
            class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6"
          >
            <div
              *ngFor="let item of wishlistItems"
              class="bg-white rounded-xl border border-stone-200 overflow-hidden group hover:shadow-lg transition"
            >
              <div class="relative aspect-square bg-stone-100 overflow-hidden">
                <img
                  [src]="item.image_path"
                  [alt]="item.name"
                  class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
                  loading="lazy"
                />
              </div>
              <div class="p-4">
                <h3 class="text-base font-semibold text-stone-900 truncate mb-1">
                  {{ item.name }}
                </h3>
                <p class="text-sm text-stone-500 mb-3">{{ item.wood_type }} · {{ item.finish }}</p>

                <div class="flex items-center justify-between mb-4">
                  <span class="text-lg font-semibold text-stone-900"
                    >${{ item.price | number : '1.0-0' }}</span
                  >
                  <button
                    (click)="removeFromWishlist(item.id)"
                    class="text-stone-400 hover:text-red-600 transition"
                    title="Remove"
                  >
                    <lucide-icon [img]="Trash" class="w-4 h-4"></lucide-icon>
                  </button>
                </div>
                <div class="space-y-2">
                  <button
                    (click)="addToCart(item)"
                    class="w-full py-2 bg-stone-900 text-white text-sm rounded-lg hover:bg-stone-800 transition"
                  >
                    Add to Cart
                  </button>

                  <div class="flex gap-2">
                    <a
                      [routerLink]="['/products', item.id]"
                      class="flex-1 py-2 text-center text-sm border border-stone-300 rounded-lg hover:bg-stone-50"
                    >
                      View Details
                    </a>
                    <button
                      class="flex-1 py-2 text-sm border border-stone-300 rounded-lg hover:bg-stone-50"
                    >
                      Share
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
</div>
